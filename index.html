<!-- RECO7609 Story Writer Webapp python backend server-->
<!--
Prompt:

Please update the code so when the webapp starts the prediction box says "I will predict your next word..." instead of "undefined"
Please update it so pressing "use bigram model" and "use trigram model" only changes the prediction word, but doesn't update the story yet.
Please update the code so only "writeWord()" function updates the story list in the python code. While "switchModel(Type)" function will only switch the prediction model (bigram or trigram) and not append the prediction word to the story list in the python code.


-->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Writer</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #story-box, #next-word-box, #auto-complete-box { border: 1px solid #000; padding: 10px; margin-bottom: 10px; }
        #next-word-box { height: 20px; }
        #auto-complete-box { height: 20px; }
    </style>
</head>
<body>
    <h1>Story Writer</h1>
    <div id="story-box">Your story will appear here...</div>
    <div id="next-word-box">I will predict your next word...</div>
    <input type="text" id="word-input" placeholder="Enter a word" oninput="autoComplete()">
    <button onclick="writeWord()">Write</button>
    <div id="auto-complete-box">Auto Complete</div>
    <button onclick="switchModel('bigram')">Use Bigram Model</button>
    <button onclick="switchModel('trigram')">Use Trigram Model</button>

    <script>
        let modelType = 'bigram';  // Default model type

        function writeWord() {
            let word = document.getElementById('word-input').value.trim();
            fetch('http://localhost:8080/write', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ word: word, model_type: modelType })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('story-box').innerText = data.story;
                document.getElementById('next-word-box').innerText = data.next_word || "I will predict your next word...";
                document.getElementById('word-input').value = '';
                document.getElementById('auto-complete-box').innerText = 'Auto Complete';
            })
            .catch(error => console.error('Error:', error));
        }

        function switchModel(type) {
            modelType = type;
            fetch('http://localhost:8080/switch', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ model_type: modelType })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('next-word-box').innerText = data.next_word || "I will predict your next word...";
            })
            .catch(error => console.error('Error:', error));
        }

        function autoComplete() {
            let currentText = document.getElementById('word-input').value.trim();
            fetch('http://localhost:8080/auto-complete', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text: currentText, model_type: modelType })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('auto-complete-box').innerText = data.suggestions.join(', ') || 'Auto Complete';
            })
            .catch(error => console.error('Error:', error));
        }

        // Fetch the initial next word prediction
        fetch('http://localhost:8080')
            .then(response => response.json())
            .then(data => {
                document.getElementById('next-word-box').innerText = data.next_word || "I will predict your next word...";
            });
    </script>
</body>
</html>
